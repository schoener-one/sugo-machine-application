{
    // See https://go.microsoft.com/fwlink/?LinkId=733558
    // for the documentation about the tasks.json format
    "version": "2.0.0",
    "tasks": [
        // X86
        {
            "label": "x86_build-init",
            "type": "shell",
            "command": "cmake -B${config:build.directory.x86} -GNinja -DCMAKE_BUILD_TYPE=${config:build.type} -DCODE_COVERAGE=ON"
        },
        {
            "label": "x86_build-MachineApplication",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target MachineApplication",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-MachineApplicationIntegrationTest",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target MachineApplicationIntegrationTest",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-ServiceComponents",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target ServiceComponents",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-CommonTest",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target CommonTest",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-ServiceComponentsTest",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target ServiceComponentsTest",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-MessageBrokerIntegrationTest",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target MessageBrokerIntegrationTest",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-MessageBroker",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target MessageBroker",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-MachineServiceComponents",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target MachineServiceComponents",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-MachineServiceComponentsTest",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target MachineServiceComponentsTest",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-HardwareAbstractionLayer",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target HardwareAbstractionLayer",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-HardwareAbstractionLayerTest",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target HardwareAbstractionLayerTest",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-HardwareAbstractionLayerSmokeTest",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target HardwareAbstractionLayerSmokeTest",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-MachineRemoteControlServer",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target MachineRemoteControlServer",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-all",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target all",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.x86}" ]
            },
            "group": "build"
        },
        {
            "label": "x86_build-clean",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.x86} --target clean"
        },
        {
            "label": "x86_build-clean-prestine",
            "type": "shell",
            "command": "rm -rf ${config:build.directory.x86}"
        },
        
        // RPI
        {
            "label": "rpi_build-init",
            "type": "shell",
            "command": ". ${config:sdk.env}; cmake -B${config:build.directory.rpi} -GNinja -DCMAKE_BUILD_TYPE=${config:build.type}"
        },
        {
            "label": "rpi_build-HardwareAbstractionLayerTest",
            "type": "shell",
            "command": ". ${config:sdk.env}; cmake --build ${config:build.directory.rpi} --target HardwareAbstractionLayerTest",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.rpi}" ]
            },
            "group": "build"
        },
        {
            "label": "rpi_build-HardwareAbstractionLayer",
            "type": "shell",
            "command": "cmake --build ${config:build.directory.rpi} --target HardwareAbstractionLayer",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.rpi}" ]
            },
            "group": "build"
        },
        {
            "label": "rpi_build-HardwareAbstractionLayerSmokeTest",
            "type": "shell",
            "command": ". ${config:sdk.env}; cmake --build ${config:build.directory.rpi} --target HardwareAbstractionLayerSmokeTest",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.rpi}" ]
            },
            "group": "build"
        },
        {
            "label": "rpi_build-all",
            "type": "shell",
            "command": ". ${config:sdk.env}; cmake --build ${config:build.directory.rpi} --target all",
            "problemMatcher": {
                "base": "$gcc",
                // "fileLocation": [ "relative", "${config:build.directory.rpi}" ]
            },
            "group": "build", "options": {}
        },
        {
            "label": "rpi_build-clean",
            "type": "shell",
            "command": ". ${config:sdk.env}; cmake --build ${config:build.directory.rpi} --target clean"
        },
        {
            "label": "rpi_build-clean-prestine",
            "type": "shell",
            "command": "rm -rf ${config:build.directory.rpi}"
        },

        // Remote Debugging
        {
            "label": "remote-gdbserver-killall",
            "type": "shell",
            "command": "ssh -o StrictHostKeyChecking=no root@${config:remote.host} -C \"killall gdbserver || true\""
        },
        {
            "label": "remote-upload-HardwareAbstractionLayerSmokeTest",
            "type": "shell",
            "command": "scp -o StrictHostKeyChecking=no \"${config:build.directory.rpi}/HardwareAbstractionLayer/test/HardwareAbstractionLayerSmokeTest\" \"root@${config:remote.host}:HardwareAbstractionLayerSmokeTest\""
        },
        {
            "label": "remote-upload-MachineConfig",
            "type": "shell",
            "command": [
                "ssh -o StrictHostKeyChecking=no root@${config:remote.host} -C \"mkdir -p HardwareAbstractionLayer/conf\";",
                "scp -o StrictHostKeyChecking=no \"${workspaceFolder}/HardwareAbstractionLayer/conf/HardwareConfig.json\" \"root@${config:remote.host}:HardwareAbstractionLayer/conf/HardwareConfig.json\""
            ]
        },
        {
            "label": "remote-start-HardwareAbstractionLayerSmokeTest.GpioControl",
            "type": "shell",
            "command": [
                "ssh -o StrictHostKeyChecking=no root@${config:remote.host} -C ",
                "\"/usr/bin/gdbserver localhost:${config:remote.port} HardwareAbstractionLayerSmokeTest ",
                "--gtest_filter=HardwareAbstractionLayerSmokeTest.Test_GpioControl\""
            ],
            "dependsOn": [
                "remote-gdbserver-killall",
                "remote-upload-HardwareAbstractionLayerSmokeTest",
                "remote-upload-MachineConfig"
            ],
            "dependsOrder": "sequence",
            "isBackground": false
        },
        {
            "label": "remote-start-HardwareAbstractionLayerSmokeTest.GpioControl-direct",
            "type": "shell",
            "command": [
                "ssh -o StrictHostKeyChecking=no root@${config:remote.host} -C ",
                "\"/usr/bin/gdbserver localhost:${config:remote.port} HardwareAbstractionLayerSmokeTest ",
                "--gtest_filter=HardwareAbstractionLayerSmokeTest.Test_GpioControl\""
            ],
            "dependsOrder": "sequence",
            "isBackground": false
        },
        {
            "label": "remote-start-HardwareAbstractionLayerSmokeTest.MotorControl",
            "type": "shell",
            "command": [
                "ssh -o StrictHostKeyChecking=no root@${config:remote.host} -C ",
                "\"/usr/bin/gdbserver localhost:${config:remote.port} HardwareAbstractionLayerSmokeTest ",
                "--gtest_filter=HardwareAbstractionLayerSmokeTest.Test_MotorControl\""
            ],
            "dependsOn": [
                "remote-gdbserver-killall",
                "remote-upload-HardwareAbstractionLayerSmokeTest",
                "remote-upload-MachineConfig"
            ],
            "dependsOrder": "sequence",
            "isBackground": false
        },
        {
            "label": "remote-start-HardwareAbstractionLayerSmokeTest.MotorControl-direct",
            "type": "shell",
            "command": [
                "ssh -o StrictHostKeyChecking=no root@${config:remote.host} -C ",
                "\"/usr/bin/gdbserver localhost:${config:remote.port} HardwareAbstractionLayerSmokeTest ",
                "--gtest_filter=HardwareAbstractionLayerSmokeTest.Test_MotorControl\""
            ],
            "dependsOrder": "sequence",
            "isBackground": false
        },
        {
            "label": "remote-start-HardwareAbstractionLayerSmokeTest.TemperatureSensorControl",
            "type": "shell",
            "command": [
                "ssh -o StrictHostKeyChecking=no root@${config:remote.host} -C ",
                "\"/usr/bin/gdbserver localhost:${config:remote.port} HardwareAbstractionLayerSmokeTest ",
                "--gtest_filter=HardwareAbstractionLayerSmokeTest.Test_TemperatureSensorControl\""
            ],
            "dependsOn": [
                "remote-gdbserver-killall",
                "remote-upload-HardwareAbstractionLayerSmokeTest",
                "remote-upload-MachineConfig"
            ],
            "dependsOrder": "sequence",
            "isBackground": false
        },
        {
            "label": "remote-start-HardwareAbstractionLayerSmokeTest.TemperatureSensorControl-direct",
            "type": "shell",
            "command": [
                "ssh -o StrictHostKeyChecking=no root@${config:remote.host} -C ",
                "\"/usr/bin/gdbserver localhost:${config:remote.port} HardwareAbstractionLayerSmokeTest ",
                "--gtest_filter=HardwareAbstractionLayerSmokeTest.Test_TemperatureSensorControl\""
            ],
            "dependsOrder": "sequence",
            "isBackground": false
        }
    ],
    "inputs": [
        {
            "id": "exec_path",
            "type": "promptString",
            "default": "${config:build.directory.rpi}",
            "description": "path to the executable"
        }
    ]
}